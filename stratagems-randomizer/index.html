<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" />
<title>Helldivers 2 - Estratagemas Aleatorias</title>
<style>
  body{margin:0;font-family:Arial, sans-serif;background:#111;color:#fff;}
  header{background:#222;padding:10px;display:flex;justify-content:space-between;align-items:center;position:relative;}
  #toggleMenu{background:#444;color:#fff;border:none;width: 44px;height: 44px;font-size:1.3em;cursor:pointer;border-radius:8px;display: flex;align-items: center;justify-content: center;}
  
  /* === T√çTULO como bot√≥n === */
  .page-title-wrapper {
    position: absolute;
    left: 50%;
    top: 65%; /* üëà M√°s abajo en escritorio */
    transform: translate(-50%, -50%);
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
  }

  #pageTitleBtn {
    background: none;
    border: none;
    font-size: 1.2em;
    font-weight: bold;
    color: #fff;
    cursor: pointer;
    padding: 0;
    line-height: 1.2;
  }

  /* üëá NUEVO: Estilo para el s√≠mbolo desplegable */
  .title-dropdown-indicator {
    font-size: 1.0em; /* üëà M√°s grande en escritorio */
    color: #9C7D2D;
    margin-top: 2px;
    line-height: 1;
    animation: pulse 2s infinite;
  }

  @keyframes pulse {
    0%, 100% { opacity: 0.7; }
    50% { opacity: 1; }
  }
  
  /* Bot√≥n de aleatorizar */
  #randomButton {
    background:#444;
    color:#fff;
    border:none;
    width: 44px;
    height: 44px;
    font-size:1.3em;
    cursor:pointer;
    border-radius:8px;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-right: 10px;
    opacity: 0.8;
    transition: opacity 0.2s;
  }
  #randomButton:hover { opacity: 1; }

  /* === BOT√ìN VOLVER === */
  #backButtonWrapper {
    text-align: center;
    margin-top: 10px;
  }

  #backButton {
    display: inline-flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 4px;
    text-decoration: none;
    color: #fff;
    background: rgba(60,60,60,0.7);
    border-radius: 8px;
    padding: 10px 16px;
    font-size: 0.9em;
    box-shadow: 0 2px 6px rgba(0,0,0,0.3);
    transition: background 0.2s;
  }

  #backButton:hover {
    background: #9C7D2D;
  }

  #backButtonWrapper.hide {
    display: none;
  }

  .back-text {
    font-size: 0.95em;
    font-weight: bold;
  }

  .back-icons {
    display: flex;
    align-items: center;
    gap: 4px;
  }

  .back-icon {
    width: 24px;
    height: 24px;
  }

  /* Panel lateral */
  #menu{position:fixed;top:0;left:0;height:100%;width:90%;max-width:400px;background:#1a1a1a;overflow-y:auto;transform:translateX(0);transition:transform .3s ease;padding:20px;z-index:9999;}
  #menu.hide{transform:translateX(-100%);}
  .menu-header{display:flex;justify-content:space-between;align-items:center;}

  /* Botones cuadrados en el header del men√∫ - reorganizados en 2 filas */
  .menu-buttons {display: flex;flex-direction: column;gap: 10px;}
  .menu-buttons-row {display: flex;gap: 10px;justify-content: flex-end;}
  .square-btn {
    width: 44px;
    height: 44px;
    background:#444;
    border:none;
    color:#fff;
    font-size:1.3em;
    cursor:pointer;
    border-radius:8px;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 0;
    transition: background 0.2s;
  }
  .square-btn:hover { background:#555; }

  h2{margin-top:20px;border-bottom:1px solid #444;padding-bottom:5px;cursor:pointer;}
  .cat-content{margin-top:10px;display:grid;grid-template-columns:repeat(auto-fill,minmax(60px,1fr));gap:12px;}
  .cat-content.hide{display:none;}

  /* Estratagema cuadro con borde claro y fondo oscuro */
  .estratagema{
    cursor:pointer;
    background:#1f1f1f;
    border:3px solid #aaa;
    border-radius:8px;
    padding:4px;
    display:flex;
    justify-content:center;
    align-items:center;
    transition:background .15s,transform .08s;
    position:relative;
    min-height:60px;
  }
  .estratagema:hover{background:#2c2c2c;transform:scale(1.05);}
  .estratagema img.icon{width:55px;height:55px;object-fit:cover;border-radius:4px;}

  /* === BOT√ìN FLOTANTE PARA VOLVER ARRIBA === */
  #scrollToTopBtn {
    position: fixed;
    bottom: 10px;
    right: 10px;
    width: 50px;
    height: 50px;
    background: rgba(68, 68, 68, 0.9); /* Gris semitransparente como los otros botones */
    color: white;
    border: none;
    border-radius: 50%;
    font-size: 1.5em;
    cursor: pointer;
    box-shadow: 0 4px 12px rgba(0,0,0,0.3);
    z-index: 10001;
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.3s, visibility 0.3s, transform 0.2s;
    display: none; /* Oculto por defecto */
  }

  #scrollToTopBtn.show {
    opacity: 1;
    visibility: visible;
  }

  #scrollToTopBtn:hover {
    background: rgba(85, 85, 85, 0.9); /* Gris un poco m√°s claro al hover */
    transform: scale(1.1);
  }

  /* === ESCRITORIO - ICONOS M√ÅS GRANDES === */
  @media (min-width: 769px) {
    .estratagema img.icon {
      width: 65px;
      height: 65px;
      object-fit: contain;
    }
    
    .estratagema {
      height: 75px;
      min-height: auto;
    }
    
    .cat-content {
      grid-template-columns: repeat(auto-fill, minmax(75px, 1fr));
      gap: 12px;
    }
  }

  /* Indicador de selecci√≥n */
  .estratagema.selected {
    border-color: #4CAF50;
    box-shadow: 0 0 10px rgba(76, 175, 80, 0.7);
  }
  .estratagema.selected::after {
    content: "‚úì";
    position: absolute;
    top: 5px;
    right: 5px;
    background: #4CAF50;
    color: white;
    width: 20px;
    height: 20px;
    border-radius: 50%;
    display: flex;
    justify-content: center;
    align-items: center;
    font-weight: bold;
  }

  /* Zona principal - ESCRITORIO */
  #seleccionadas{margin:20px auto;max-width:1200px;display:grid;gap:20px;padding:20px;grid-template-columns: repeat(1, 1fr);}
  .card{background:#222;border-radius:10px;padding:10px;box-shadow:0 0 8px #000;display:flex;flex-direction:column;align-items:flex-start;}
  .fila{width:100%;display:flex;align-items:center;justify-content:space-between;gap:15px;}
  .fila img.arrow{width:36px;height:36px;margin:0 2px;}
  .nombre{margin-top:8px;font-size:1.1em;font-weight:bold;width:100%;text-align:left;}

  /* Modal idioma */
  #langModal{position:fixed;inset:0;background:rgba(0,0,0,.7);display:flex;justify-content:center;align-items:center;z-index:10000;}
  #langModal .box{background:#222;padding:18px;border-radius:12px;text-align:center;}
  #langModal button{margin:8px;padding:10px 18px;font-size:1.05em;cursor:pointer;border:none;border-radius:8px;background:#444;color:white;}
  #langModal .note{font-size:0.9em;color:#ccc;margin-top:8px;}

  /* === Espacio extra al final del panel lateral === */
  #categorias::after {
    content: "";
    display: block;
    height: 60px;
  }

  /* Media queries para M√ìVIL */
  @media (max-width: 768px) {
    header {
      display: grid;
      grid-template-columns: 44px 1fr 44px;
      grid-template-areas: "random title menu";
      align-items: center;
      gap: 10px;
      padding: 10px;
    }
    #randomButton { grid-area: random; margin-right: 0; }
    .page-title-wrapper {
      grid-area: title;
      position: static;
      transform: none;
      margin-top: 12px; /* üëà M√°s abajo en m√≥vil */
    }
    #pageTitleBtn {
      font-size: 1em;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    /* üëá AJUSTE M√ìVIL para el indicador */
    .title-dropdown-indicator {
      font-size: 0.9em; /* üëà M√°s grande en m√≥vil */
      margin-top: 1px;
    }
    #toggleMenu { grid-area: menu; }
    #seleccionadas {
      grid-template-columns: repeat(1, 1fr);
      gap: 15px;
      padding: 15px;
    }
    #seleccionadas.mas-de-5 { grid-template-columns: repeat(2, 1fr); max-width: 100%; }
    #seleccionadas.mas-de-5 .card {
      flex-direction: column;
      align-items: center;
      padding: 8px;
    }
    #seleccionadas.mas-de-5 .fila { flex-direction: column; gap: 8px; }
    #seleccionadas.mas-de-5 .fila img:first-child { width: 50px; height: 50px; }
    #seleccionadas.mas-de-5 .nombre { display: none; }
    #seleccionadas.mas-de-5 .fila img.arrow { width: 24px; height: 24px; }
    #seleccionadas.mas-de-5 .card:nth-child(n+11) { display: none; }

    /* üëá MOSTRAR BOT√ìN SOLO EN M√ìVILES */
    #scrollToTopBtn {
      display: block; /* Visible solo en m√≥viles */
    }
  }

  /* üëá NUEVO: evita scroll lateral/zoom tipo app */
  html, body {
    overscroll-behavior: none;
    overflow-x: hidden;
    touch-action: manipulation;
  }
</style>
</head>
<body>
<header>
  <button id="randomButton" title="Mostrar 4 estratagemas aleatorias de las seleccionadas" aria-label="Mostrar 4 estratagemas aleatorias">üîÑ</button>

  <div class="page-title-wrapper">
    <button id="pageTitleBtn">
      <span id="pageTitle">RULETA DE LIBERTAD</span>
      <div class="title-dropdown-indicator">‚ñº</div> <!-- üëà NUEVA L√çNEA -->
    </button>
  </div>

  <button id="toggleMenu" title="Abrir men√∫ de estratagemas">‚ò∞</button>
</header>

<!-- üëá NUEVO: Bot√≥n VOLVER -->
<div id="backButtonWrapper" class="hide">
  <a href="../index.html" id="backButton">
    <span class="back-icons">üõ†Ô∏è <img src="https://i.imgur.com/f0pKLzX.png" class="back-icon" alt="HD2 Logo"> üõ†Ô∏è</span>
    <span class="back-text">VOLVER</span>
  </a>
</div>

<!-- Modal idioma -->
<div id="langModal" role="dialog" aria-modal="true">
  <div class="box">
    <h2>Choose Language / Elige Idioma</h2>
    <div>
      <button data-lang="en" id="btnEn">üá∫üá∏ English</button>
      <button data-lang="es" id="btnEs">üá™üá∏ Espa√±ol</button>
    </div>
  </div>
</div>

<!-- Panel -->
<div id="menu" aria-hidden="false">
  <div class="menu-header">
    <h1 id="menuTitle">Selecciona Estratagemas</h1>
    <div class="menu-buttons">
      <div class="menu-buttons-row">
        <!-- üëá REORDENADO: primero idioma, luego cerrar -->
        <button class="square-btn" id="reopenLang" title="Cambiar idioma">üåê</button>
        <button class="square-btn" id="closeMenu" title="Cerrar men√∫">‚ò∞</button>
      </div>
      <div class="menu-buttons-row">
        <button class="square-btn" id="selectAllButton" title="Seleccionar todas las estratagemas">‚úÖ</button>
        <button class="square-btn" id="randomMenuButton" title="Mostrar 4 aleatorias de las seleccionadas">üîÑ</button>
      </div>
    </div>
  </div>
  <div id="categorias"></div>
</div>

<!-- Bot√≥n flotante para volver arriba - SOLO en el men√∫ -->
<button id="scrollToTopBtn" class="scroll-top-btn" title="Volver arriba">‚Üë</button>

<main id="seleccionadas" aria-live="polite"></main>

<script>
document.addEventListener('DOMContentLoaded', ()=>{

  const arrowImgs = {
    up:   "https://static.wikia.nocookie.net/helldivers_gamepedia/images/5/51/Up_Arrow.png",
    down: "https://static.wikia.nocookie.net/helldivers_gamepedia/images/1/13/Down_Arrow.png",
    left: "https://static.wikia.nocookie.net/helldivers_gamepedia/images/4/4e/Left_Arrow.png",
    right:"https://static.wikia.nocookie.net/helldivers_gamepedia/images/3/3c/Right_Arrow.png"
  };

  let estratagemas = [];
  let currentLang = 'es';
  let todasSeleccionadas = false;
  let seleccionadasIds = new Set();

  // refs
  const langModal = document.getElementById('langModal');
  const btnEn = document.getElementById('btnEn');
  const btnEs = document.getElementById('btnEs');  
  const reopenLang = document.getElementById('reopenLang');
  const menu = document.getElementById('menu');
  const categoriasDiv = document.getElementById('categorias');
  const seleccionadas = document.getElementById('seleccionadas');
  const toggleMenu = document.getElementById('toggleMenu');
  const closeMenu = document.getElementById('closeMenu');
  const randomButton = document.getElementById('randomButton');
  const selectAllButton = document.getElementById('selectAllButton');
  const randomMenuButton = document.getElementById('randomMenuButton');
  const pageTitle = document.getElementById('pageTitle');
  const pageTitleBtn = document.getElementById('pageTitleBtn');
  const backWrapper = document.getElementById('backButtonWrapper');
  const backText = document.querySelector('#backButton .back-text');
  const scrollToTopBtn = document.getElementById('scrollToTopBtn'); // üëà NUEVO

  // üëá NUEVO: Funcionalidad del bot√≥n VOLVER
  pageTitleBtn.addEventListener('click', () => {
    backWrapper.classList.toggle('hide');
  });

  // üëá NUEVO: Mostrar/ocultar bot√≥n al hacer scroll en el men√∫ (solo en m√≥viles)
  menu.addEventListener('scroll', () => {
    // Solo funcionar en dispositivos m√≥viles
    if (window.innerWidth <= 768) {
      if (menu.scrollTop > 200) {
        scrollToTopBtn.classList.add('show');
      } else {
        scrollToTopBtn.classList.remove('show');
      }
    }
  });

  // üëá NUEVO: Funci√≥n para volver arriba
  scrollToTopBtn.addEventListener('click', () => {
    menu.scrollTo({
      top: 0,
      behavior: 'smooth'
    });
  });

  // üëá NUEVO: Ocultar bot√≥n cuando el men√∫ se cierre
  toggleMenu.addEventListener('click', () => {
    if (!menu.classList.contains('hide')) {
      // Men√∫ se abre - resetear posici√≥n scroll
      setTimeout(() => {
        scrollToTopBtn.classList.remove('show');
      }, 300);
    }
  });

  closeMenu.addEventListener('click', () => {
    scrollToTopBtn.classList.remove('show');
  });

  // üëá NUEVO: Ocultar bot√≥n si se redimensiona a escritorio
  window.addEventListener('resize', () => {
    if (window.innerWidth > 768) {
      scrollToTopBtn.classList.remove('show');
    }
  });

  // listeners del modal
  btnEn.addEventListener('click', ()=> chooseLang('en'));
  btnEs.addEventListener('click', ()=> chooseLang('es'));  
  reopenLang.addEventListener('click', ()=> { langModal.style.display = 'flex'; });
  toggleMenu.addEventListener('click', ()=> menu.classList.toggle('hide'));
  closeMenu.addEventListener('click', ()=> menu.classList.add('hide'));
  randomButton.addEventListener('click', ()=> mostrarEstratagemasAleatorias(4));
  randomMenuButton.addEventListener('click', ()=> mostrarEstratagemasAleatorias(4));
  selectAllButton.addEventListener('click', toggleSelectAll);

  // cerrar modal/men√∫ con Escape
  document.addEventListener('keydown', (e)=>{
    if(e.key === 'Escape') {
      if(langModal.style.display === 'flex') langModal.style.display = 'none';
      else menu.classList.add('hide');
    }
  });

  // üëá NUEVO: bloquear zoom por doble-tap
  document.addEventListener('touchend', e=>{
    if(e.touches.length > 1) e.preventDefault();
  }, {passive:false});

  // üëá NUEVO: evitar desplazamiento vertical/horizontal con dos dedos
  document.addEventListener('gesturestart', e=> e.preventDefault());

document.querySelectorAll('.btn').forEach(b => {
  b.addEventListener('click', () => {
    if (inputLocked) return;
    addDir(b.dataset.dir);
  });
});

  function chooseLang(lang){
    currentLang = lang;
    langModal.style.display = 'none';
    updatePageTitle();
    
    // üëá NUEVO: Actualizar texto del bot√≥n VOLVER seg√∫n idioma
    backText.textContent = currentLang === 'en' ? 'BACK' : 'VOLVER';
    
    if(estratagemas.length) renderMenu();
    updateSelectedNames();
  }

  function updatePageTitle() {
    pageTitle.textContent = currentLang === 'en' ? 'FREEDOM ROULETTE' : 'RULETA DE LIBERTAD';
  }

  function mostrarEstratagemasAleatorias(count) {
    seleccionadas.innerHTML = '';
    if (seleccionadasIds.size === 0) {
      alert(currentLang === 'en'
        ? 'No stratagems selected. Please select some first.'
        : 'No hay estratagemas seleccionadas. Por favor selecciona algunas primero.');
      return;
    }
    const idsArray = Array.from(seleccionadasIds);
    const numToSelect = Math.min(count, idsArray.length);
    const randomSelection = [];
    const availableIndices = [...idsArray];

    for (let i = 0; i < numToSelect; i++) {
      const randomIndex = Math.floor(Math.random() * availableIndices.length);
      const selectedId = availableIndices.splice(randomIndex, 1)[0];
      const item = estratagemas.find(e => e.id === selectedId);
      if (item) randomSelection.push(item);
    }

    randomSelection.forEach(item => addCardToSelection(item));
    updateGridColumns();
    menu.classList.add('hide');
  }

  function toggleSelectAll() {
    if (todasSeleccionadas) {
      seleccionadasIds.clear();
      updateSelectionVisuals();
      todasSeleccionadas = false;
      selectAllButton.textContent = '‚úÖ';
      selectAllButton.title = currentLang === 'en'
        ? 'Select all stratagems'
        : 'Seleccionar todas las estratagemas';
    } else {
      seleccionadasIds.clear();
      estratagemas.forEach(item => {
        const catEn = item.category.en || '';
        if (catEn !== 'MISSION') seleccionadasIds.add(item.id);
      });
      updateSelectionVisuals();
      todasSeleccionadas = true;
      selectAllButton.textContent = '‚ùå';
      selectAllButton.title = currentLang === 'en'
        ? 'Deselect all stratagems'
        : 'Deseleccionar todas las estratagemas';
    }
  }

  function updateSelectionVisuals() {
    document.querySelectorAll('.estratagema').forEach(el => {
      const id = el.dataset.id;
      if (seleccionadasIds.has(id)) el.classList.add('selected');
      else el.classList.remove('selected');
    });
  }

  function addCardToSelection(item) {
    const card = document.createElement('div');
    card.className = 'card';
    card.dataset.id = item.id;

    const fila = document.createElement('div');
    fila.className = 'fila';

    const icon = document.createElement('img');
    icon.src = item.image;
    icon.width = 60; icon.height = 60;
    icon.alt = item.name[currentLang] || item.name.en || item.name.es || '';

    const arrows = document.createElement('div');
    (item.combo || []).forEach(dir=>{
      const a = document.createElement('img');
      a.className = 'arrow';
      a.src = arrowImgs[dir] || arrowImgs[dir.toLowerCase()] || '';
      a.alt = dir;
      arrows.appendChild(a);
    });

    fila.appendChild(icon);
    fila.appendChild(arrows);

    const nombreDiv = document.createElement('div');
    nombreDiv.className = 'nombre';
    nombreDiv.textContent = item.name[currentLang] || item.name.en || item.name.es || '';

    card.appendChild(fila);
    card.appendChild(nombreDiv);
    seleccionadas.appendChild(card);
  }

  async function cargarEstratagemas() {
    try {
      const url = 'https://raw.githubusercontent.com/Kart0/HD2-STRATAGEMS/refs/heads/main/estratagemas.json';
      const res = await fetch(url);
      if(!res.ok) throw new Error(`HTTP ${res.status} ${res.statusText}`);
      const data = await res.json();
      estratagemas = data.filter(item => {
        const catEn = item.category.en || '';
        return catEn !== 'MISSION';
      });
      renderMenu();
    } catch (err) {
      console.error('Error cargando estratagemas.json:', err);
    }
  }

  function renderMenu(){
    categoriasDiv.innerHTML = '';
    document.getElementById('menuTitle').textContent =
      currentLang === 'en' ? 'Select Stratagems' : 'Selecciona Estratagemas';

    const grupos = {};
    estratagemas.forEach(item=>{
      const en = item.category.en || '';
      const es = item.category.es || '';
      const key = en + '||' + es;
      if(!grupos[key]) grupos[key] = { en, es, items: [] };
      grupos[key].items.push(item);
    });

    const desiredOrder = ['OFFENSIVE||OFENSIVAS','SUPPLY||SUMINISTROS','DEFENSIVE||DEFENSIVAS'];
    const keysOrdered = [];
    desiredOrder.forEach(k=> { if(grupos[k]) keysOrdered.push(k); });
    Object.keys(grupos).forEach(k=>{ if(!keysOrdered.includes(k)) keysOrdered.push(k); });

    keysOrdered.forEach(key=>{
      const group = grupos[key];
      if(!group) return;
      const catDiv = document.createElement('div');
      catDiv.className = 'categoria';

      const header = document.createElement('h2');
      header.className = 'cat-header';
      header.dataset.en = group.en;
      header.dataset.es = group.es;
      header.textContent = (currentLang === 'en' ? group.en : group.es) + ' ‚ñæ';

      const content = document.createElement('div');
      content.className = 'cat-content';

      group.items.forEach(it=>{
        const box = document.createElement('div');
        box.className = 'estratagema';
        box.dataset.id = it.id;
        box.dataset.en = it.name.en;
        box.dataset.es = it.name.es;
        box.dataset.img = it.image;
        box.dataset.combo = (it.combo || []).join(',');

        if (seleccionadasIds.has(it.id)) box.classList.add('selected');

        const img = document.createElement('img');
        img.className = 'icon';
        img.src = it.image;
        img.alt = it.name[currentLang] || it.name.en || it.name.es || '';
        box.appendChild(img);

        box.addEventListener('click', ()=> toggleEstratagemaSelection(it.id));
        content.appendChild(box);
      });

      header.addEventListener('click', ()=>{
        content.classList.toggle('hide');
        const isHidden = content.classList.contains('hide');
        header.textContent =
          (currentLang === 'en' ? group.en : group.es) + (isHidden ? ' ‚ñ∏' : ' ‚ñæ');
      });

      catDiv.appendChild(header);
      catDiv.appendChild(content);
      categoriasDiv.appendChild(catDiv);
    });
  }

  function toggleEstratagemaSelection(id) {
    if (seleccionadasIds.has(id)) seleccionadasIds.delete(id);
    else seleccionadasIds.add(id);
    updateSelectionVisuals();

    const totalEstratagemas = estratagemas.filter(e => (e.category.en || '') !== 'MISSION').length;
    todasSeleccionadas = seleccionadasIds.size === totalEstratagemas;
    selectAllButton.textContent = todasSeleccionadas ? '‚ùå' : '‚úÖ';
    selectAllButton.title = todasSeleccionadas
      ? (currentLang === 'en' ? 'Deselect all stratagems' : 'Deseleccionar todas las estratagemas')
      : (currentLang === 'en' ? 'Select all stratagems' : 'Seleccionar todas las estratagemas');
  }

  function updateGridColumns(){
    const total = seleccionadas.children.length;
    if (window.innerWidth <= 768) {
      if (total > 5) {
        seleccionadas.classList.add('mas-de-5');
        seleccionadas.style.gridTemplateColumns = 'repeat(2, 1fr)';
      } else {
        seleccionadas.classList.remove('mas-de-5');
        seleccionadas.style.gridTemplateColumns = 'repeat(1, 1fr)';
      }
    } else {
      seleccionadas.classList.remove('mas-de-5');
      const cols = Math.max(1, Math.ceil(total / 5));
      seleccionadas.style.gridTemplateColumns = `repeat(${cols}, 1fr)`;
    }
  }

  function updateSelectedNames(){
    if(!estratagemas.length) return;
    document.querySelectorAll('#seleccionadas .card').forEach(card=>{
      const id = card.dataset.id;
      const info = estratagemas.find(x => x.id === id);
      if(info){
        const nuevo = info.name[currentLang] || info.name.en || info.name.es;
        const nombreDiv = card.querySelector('.nombre');
        if(nombreDiv) nombreDiv.textContent = nuevo;
        const icon = card.querySelector('img');
        if(icon) icon.alt = info.name[currentLang] || icon.alt;
      }
    });
  }

  window.addEventListener('resize', updateGridColumns);
  cargarEstratagemas();
});
</script>
</body>
</html>